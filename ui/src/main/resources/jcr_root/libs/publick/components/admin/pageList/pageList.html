<div data-ng-controller="newPageController" data-sly-use.page="com.nateyolles.sling.publick.components.admin.PageEdit" data-sly-unwrap></div>
<!--<div data-sly-use.pageconf="com.nateyolles.sling.publick.components.admin.PageConfigurationEdit" data-sly-unwrap></div>-->
<div data-sly-use.config="com.nateyolles.sling.publick.components.admin.DispatcherConfig" data-sly-unwrap></div>
<div data-ng-controller="PageListController" data-sly-use.list="com.nateyolles.sling.publick.components.admin.PageList">

    <input type="hidden" name="dispatcherHost" data-ng-model="model.dispatcherHost" data-ng-init="model.dispatcherHost = '${config.dispatcherHost}'">
    <input type="hidden" name="dispatcherInvalidateCacheUri" data-ng-model="model.dispatcherInvalidateCacheUri" data-ng-init="model.dispatcherInvalidateCacheUri = '${config.dispatcherInvalidateCacheUri}'">
   
    <!--<div class="row">-->
        <!--<div class="alert {{model.alert_css}} text-center col-lg-12 col-md-12 scollable-x bottom-buffer">-->
            <!--<strong>{{model.status}}</strong> {{model.msg}}-->
        <!--</div>-->
    <!--</div>-->
    <!--<div class = "alert {{model.alert_css}} alert-dismissable fade in"><button type = "button" class = "close" data-dismiss = "alert" aria-hidden = "true">&times;</button><strong>{{model.status}}</strong> {{model.msg}}</div>-->
    <div id="alert_placeholder" class="row"></div>
    <!--<div id="alert_placeholder" class = "alert {{model.alert_css}} alert-dismissable fade in">-->
    <!--</div>-->

    <div class="row" data-sly-test="${!list.pages}">
        <div class="col-xs-12 alert alert-info" role="alert">Welcome to the siteadmin page, here you can create and organize pages and folders.</div>
        
        <div class="col-xs-12">
            <h2 class="create-first-page"><a class="cursor-pointer" data-ng-click="newNodeContext('page', 'page');"><i class="glyphicon glyphicon-pencil"></i>Create first page</a></h2>
        </div>
    </div>

    <div class="row" data-sly-test="${list.pages}">
        <div class="col-lg-3 col-md-4 scollable-x bottom-buffer" style="border-right: 1px solid #ddd;height: 600px;">
            <div style="color: #337ab7;" id="clbk" class="demo"></div>
        </div>

        
        <div class="col-lg-9 col-md-8 bottom-buffer" style="margin-top: 20px">
            <ul class="nav nav-pills" id="myTab">
                <li class="active"><a href="#" data-target="#preview" data-toggle="tab">Page Preview</a></li>
                <li><a href="#" data-target="#subpages" data-toggle="tab">Subpages</a></li>
            </ul>

            <div class="tab-content">
                <div class="tab-pane fade in active" id="preview">
                    <div class="row" data-ng-show="pageContent" style="margin-top: 20px" ng-cloak>
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>Link/URL</th>
                                <th class="column-extra-small"></th>
                                <th class="column-small">Edit</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td><a href="{{prefix_path}}{{pageContent.selectedNode}}.html" target="_blank" title="Open page">{{pageContent.pageTitle || "// No SEO title available" }}</a>
                                    <span class="text-muted pagelist-muted">{{prefix_path}}{{pageContent.selectedNode}}.html</span>
                                </td>
                                <td><i class="glyphicon" data-ng-class="pageContent.visible ? 'glyphicon-eye-open' : 'glyphicon-eye-close'"></i></td>
                                <td><a data-ng-click="editNodeContext(prefix_path, pageContent.selectedNode)"><i style="cursor:pointer" class="glyphicon glyphicon-pencil"></i></a></td>
                            </tr>
                            <tr>
                                <td colspan="3" data-ng-show="pageContent.description">
                                    {{pageContent.description | limitTo: 450}}{{pageContent.description.length > 450 ? ' ...' : ''}}
                                </td>
                                <td colspan="3" data-ng-show="!pageContent.description && pageContent.content">
                                    {{pageContent.content | limitTo: 450}}{{pageContent.content.length > 450 ? ' ...' : ''}}
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div><!-- // END row -->
                    <div data-ng-show="!pageContent" ng-cloak>
                        <h4 style="text-align: center;margin-top: 250px">Please select a node to display information about it.</h4>
                    </div>
                </div>
                <div class="tab-pane fade" id="subpages">
                    <div class="row" data-ng-show="pageList" style="margin-top: 20px" ng-cloak>
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>Link/URL</th>
                                <th class="column-extra-small"></th>
                                <th class="column-small">Edit</th>
                            </tr>
                            </thead>
                            <tbody data-ng-repeat="list in pageList">
                            <tr>
                                <td><a href="{{prefix_path_child}}{{list.text}}.html" target="_blank" title="Open page">{{list.pageTitle || "// No SEO title available" }}</a> <span class="text-muted pagelist-muted">{{prefix_path_child}}{{list.text}}.html</span></td>
                                <td><i class="glyphicon" data-ng-class="list.visible ? 'glyphicon-eye-open' : 'glyphicon-eye-close'"></i></td>
                                <td><a data-ng-click="editNodeContext(prefix_path_child, list.text)"><i style="cursor:pointer" class="glyphicon glyphicon-pencil"></i></a></td>
                            </tr>
                            </tbody>
                        </table>
                    </div><!-- // END row -->
                    <div data-ng-show="!pageList" ng-cloak>
                        <h4 style="text-align: center;margin-top: 250px">Please select a node to display information about it.</h4>
                    </div>
                </div>
            </div>

        </div><!-- // END col -->


    </div><!-- // END row -->
</div>

<script type="text/ng-template" id="templateId">

</script>